<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DedalusWeb sample: Cloak of darkness</title>

    <script src="http://olado.github.io/doT/doT.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
    <script src="../src/dedalus.js"></script>
    <script src="../src/dedalus-web.js"></script>

    <link rel="stylesheet" href="dedalus-web.css">

 </head>
<body>
    <div id="story">

        <initscript>
            story.messageDamage  = 0;
            story.messageScrewed = function () { return story.messageDamage < 2; };
            story.cloakPutOn     = false;
            story.cloakJustPutOn = false;
        </initscript>

        <!-- Novel -->
        <title>Dindledoo Entertainment presents</title>

        <!-- Objects -->
        <obj id="cloak" inventoryName="Cloak">
            <action id="Examine">
                {{? story.currentPageIs('bar') && !story.cloakPutOn}}
                    {{ story.showParagraph('darkWarning'); }}
                {{??}}
                    A handsome cloak, of velvet trimmed with satin, and slightly spattered with raindrops. Its blackness is so deep that it almost seems to suck light from the room.
                {{?}}
            </action>

            <action id="Get">
                <when>!story.isInInventory('cloak')</when>
                You take the cloak from the hung with you.
                {{ story.putInInventory('cloak'); }}
            </action>

            <action id="Drop">
                <when>story.isInInventory('cloak')</when>

                {{? story.currentPageIs('bar') && !story.cloakPutOn }}
                    {{ story.showParagraph('darkWarning'); }}
                {{??}}
                    This isn't the best place to leave a smart cloak lying around.
                {{?}}
            </action>

            <action id="Put On">
                <when>story.isInInventory('cloak') && !story.cloakPutOn</when>
                {{ story.cloakPutOn = true; }}
                {{? story.currentPageIs('bar')}}
                    {{story.cloakJustPutOn = true;}}
                    {{story.turnTo('bar');}}
                {{??}}
                    You put on the cloak. It dresses fine on you!.
                {{?}}
            </action>
        </obj>

        <!-- Pages -->
        <page id="intro">
            <p>Hello there! Welcome to the world of Pokémon! My name is Jeffrey and people call me Poké-Professor Dindledoo! This world is inhabited by creatures called Pokémon!</p>

            <div class="first">Some people think Pokémon are pets. Others use them for fights. Your very own Pokémon legend is about to unfold. A world of dreams and adventures with Pokémon awaits... Let's go!<br><br> *Begins to walk on grass.*</div>

            <br>

            <div class="first">Dindledoo: Hey! Wait! It's unsafe. Wild Pokémon live in tall grass. You need your own Pokémon for your protection.</div>
        </page>

        <page id="foyer" class="first">
            <p>There are 3 Pokémon here! They are inside the PokéBalls. You can have one. Choose! <turn to="Charmander">Charmander</turn>, <turn to="bar" id="south">Squirtle</turn>, or <turn to="Bulbasaur">Bulbasaur</turn>.</p>

        </page>

        <page id="Charmander">
            <p>Charmander<br><br>Lizard | HT : 2'00" | WT : 19.0 lb<br><br>Obviously prefers hot places. When it rains, steam is said to spout from the tip of its tail.<br><br>So! You want the fire Pokémon Charmander? <turn to="Charmander1">Yes</turn>. <turn to="foyer">No</turn>.</p>
        </page>

        <page id="Charmander1">
            <p>Char char</p>
        </page>

        <page id="Bulbasaur">
            <p>Bublasaur<br><br>Seed | HT : 2'04" | WT : 15.0 lb<br><br>A strange seed was planted on its back at birth. The plant sprouts and grows with this Pokémon.<br><br>So! You want the grass Pokémon Bulbasaur? <turn to="Bulbasaur1">Yes</turn>. <turn to="foyer">No</turn>.</p></p>
        </page>

        <page id="Bulbasaur1">
            <p>Bulba bulba</p>
        </page>



                <interact with="hook">one</interact> remains. The exit is a door to the <turn to="foyer">east</turn>.

            <obj id="hook">
                <action id="Examine">
                    It's just a small brass hook {{? story.isInInventory('cloak')}}screwed to the wall{{??}}with a <interact with="cloak">cloak</interact> hanging on it{{?}}.
                </action>
            </obj>
        </page>

        <page id="bar">
            {{? !story.cloakPutOn}}
                <p>Squirtle<br><br>Tiny Turtle | HT : 1'08" | WT : 20.0 lb<br><br>After birth, its back swells and hardens into a shell. Powerfully sprays foam from its mouth.<br><br>So! You want the water Pokémon Squirtle? <turn to="Squirtle1">Yes</turn>. <turn to="foyer">No</turn>.</p>
        
            {{??}}
                {{? story.cloakJustPutOn }}
                    <p>The cloak seems to absorb the darkness and you can gradually see the room.</p>
                    <p>You put on the cloak. It dresses fine on you!.</p>
                    {{story.cloakJustPutOn = false;}}
                {{?}}
                The bar, much rougher than you'd have guessed after the opulence of the <turn to="foyer">foyer</turn>, is completely empty. There seems to be some sort of <interact with="message">message</interact> scrawled in the sawdust on the floor.
            {{?}}

            <obj id="message">
                <action id="Read">
                    {{? story.messageScrewed() }}
                        The message, neatly marked in the sawdust, reads...
                        <div class="center">*** You have won ***</div>
                        {{story.endGame();}}
                    {{??}}
                        The message has been carelessly trampled, making it difficult to read. You can just distinguish the words...
                        <div class="center">*** You have lost ***</div>
                        {{story.endGame();}}
                    {{?}}
                </action>
            </obj>

            <paragraph id="movingInTheDark">
                Blundering around in the dark isn't a good idea!
                {{story.messageDamage += 2;}}
            </paragraph>
        </page>
        
        <page id="Squirtle1">
            <p>Squir squir</p>
        </page>

        <!-- Paragraphs -->
        <paragraph id="darkWarning">
            It is very dark here, you can't even see your hands.
        </paragraph>

    </div>

    <div id="title"></div>
    <div class="textSeparatorLarge">
        <img src="deco-title.png" alt="">
    </div>

    <div id="inventoryHostWrapper">
        <h2>Inventory</h2>
        <div class="textSeparatorSmall">
            <img src="deco-inventory.png" alt="">
        </div>
        <div id="inventoryHost" class="glow"></div>
    </div>

    <div id="host"></div>

    <div id="interactionHost" class="glow"></div>

    <div id="undoStageHost"></div>

    <div id="footer">
        <a id="undoHost" href="#">Undo</a>
        <a id="saveHost" href="#">Save</a>
        <a id="restoreHost" href="#">Restore</a>
        <a id="reseteHost" href="#">Reset</a>
    </div>

    <script>
        $(function () {
            new DedalusWeb({
                domSource         : $('#story'),
                domTarget         : $('#host'),
                titleTarget       : $('#title'),
                inventoryTarget   : $('#inventoryHost'),
                interactionTarget : $('#interactionHost'),
                undoTarget        : $('#undoHost'),
                undoStageTarget   : $('#undoStageHost'),
                saveTarget        : $('#saveHost'),
                restoreTarget     : $('#restoreHost'),
                resetTarget       : $('#reseteHost'),
            });
        });

    </script>
</body>
</html>
